{% extends 'bootstrap.html' %}

{% block bootstrap3_title %}{{ title }}{% endblock %}

{% block usercss %}
{% endblock %}

{% block bootstrap3_content %}
   成功通过认证，获取用户信息中。。。
{% endblock %}

{% block js_post %}
{{ block.super }}
<script>
   var parseQueryString = function (qs) {
      var e,
         a = /\+/g,  // Regex for replacing addition symbol with a space
         r = /([^&;=]+)=?([^&;]*)/g,
         d = function (s) { return decodeURIComponent(s.replace(a, " ")); },
         q = qs,
         urlParams = {};

      while (e = r.exec(q))
         urlParams[d(e[1])] = d(e[2]);

      return urlParams;
   }

    var h = window.location.hash;
    h = h.substring(1);
    var atoken = parseQueryString(h);
    var token = atoken["access_token"];
    console.log(token);

    var url = 'https://graph.qq.com/oauth2.0/me?callback=callback&access_token="+token;
    $.ajax({
      url:url
    }).done(function(data) {
      console.log(data);
    });
</script>
{% endblock %}

