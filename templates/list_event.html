{% extends 'dh5mbp/base.html' %}
{% load url from future %}
{% load staticfiles %}

{% block title %}{{ title }}{% endblock %}

{% block dh5mbp_css %}
    {{block.super}}
    <style>
        table {
            color: black;
            background: #fff;
            border: 1px solid #b4b4b4;
            font: bold 17px helvetica;
            padding: 0;
            margin-top:10px;
            width: 100%;
            -webkit-border-radius: 8px;
        }

        table tr td {
            color: #666;
            border-bottom: 1px solid #b4b4b4;
            border-right: 1px solid #b4b4b4;
            padding: 10px 10px 10px 10px;
            background-image: -webkit-linear-gradient(top, #fdfdfd, #eee);
        }

        table tr td:last-child {
            border-right: none;
        }

        table tr:last-child td {
            border-bottom: none;
        }

    </style>
{% endblock %}
{% block content %}

    <body>
            {% if type == 'mine' %}
                <h3 style="text-align:center">以下是您发布的活动，点击标题可查看或编辑：</h3>
            {% elif type == 'other' %}
                <h3 style="text-align:center">以下是您参与的活动，点击标题可查看或修改：</h3>
            {% endif %}

                <p>
                    <table border="1px" cellspacing="0px" style="border-collapse:collapse">
                        <tr>
                            <td>活动名称</td>
                            <td>活动时间</td>
                        </tr>
                        {% for event in events %}
                        <tr>
                            <td><a href="/showevent/?eventid={{ event.id }}" >{{ event.event_title }} </a></td>
                            <td>{{ event.event_date|date:"Y-m-d, H:i" }}</td>
                        </tr>
                        {% endfor %}
                    </table>
                </p>

    <div style="text-align:center">
        <!-- 如果当前是第一页，就不显示【上一页】链接 -->
        {% ifnotequal curPage 1 %}
            <a href="?curPage={{ curPage }}&&allPage={{ allPage }}&&pageType=pageUp&&type={{type}}">
                上一页
            </a>
        {% endifnotequal %}

        第{{ curPage }}/{{ allPage }}页

         <!-- 如果当前是最后一页，就不显示【下一页】链接 -->
        {% if curPage < allPage %}
            <a href="?curPage={{ curPage }}&&allPage={{ allPage }}&&pageType=pageDown&&type={{type}}">
                下一页
            </a>
        {% endif %}
    </div>

<div id="adminlinks">
{% if user.is_authenticated and user != "" %}
    ========={{ user }}
    +++++++++{{ user.is_authenticated }}
    <p>Welcome, {{ user.username }}. Thanks for logging in.</p>
    <li><a href = "/list_events/?type=mine"> 我发布的活动 </a></li>
    <li><a href = "/list_events/?type=other"> 我参与的活动 </a></li>
        <li><a href = "/add_event/"> add_event </a></li>
    <li><a href = "/accounts/logout/"> 退出 </a></li>
    <li><a href = "/admin/"> 管理界面 </a></li>
{% else %}
    <p>Welcome, new user. Please log in.</p>
    <li><a href ="/accounts/login/?next=/"> 登录 </a></li>
    <li><a href ="/accounts/register/?next=/"> 注册 </a></li>
{% endif %}
</div>
    </body>

{% endblock %}

{% block post_main_script %}
{{ block.super }}
<script type="text/javascript">
         $(document).ready(function() {
          // disable ajax nav
          $.mobile.ajaxEnabled = false;

          if (!navigator.userAgent.match(/mobile/i)) {
            $("#adminlinks").show();
          }else{
            $("#adminlinks").hide();
          }
         });

</script>
{% endblock %}